import{Bt as e,Ft as t,Kt as s,Rt as a,St as r,Yt as o,_t as l,bt as n,et as i,ft as c,i as u,rn as d,rt as m,st as g,tn as p,wt as b,xt as x,yt as f}from"./main.js";import"./newStorage.js";var h={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},y={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-6 dark:text-white dark:bg-gray-900"},v={class:"grid grid-cols-1 lg:grid-cols-2 gap-8"},w={class:"bg-white rounded-lg shadow-sm border p-6 dark:bg-gray-800"},j={class:"space-y-4"},k=["disabled"],$={class:"bg-white rounded-lg shadow-sm border p-6 dark:bg-gray-800"},W={class:"space-y-4"},S=["disabled"],N={class:"mt-8 bg-white rounded-lg shadow-sm border p-6 dark:bg-gray-800"},E={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},D={class:"flex items-center gap-3 mb-2"},U={class:"text-2xl"},C={class:"font-medium text-gray-900"},J={class:"text-xs text-gray-500"},O=["onClick","disabled"],T={key:0,class:"mt-8 bg-white rounded-lg shadow-sm border p-6"},I={class:"space-y-3"},A={class:"flex items-center gap-3"},L={class:"font-medium text-gray-900"},M={class:"text-sm text-gray-600"},R=["onClick"],G={class:"p-4"},_={class:"flex"},H={class:"flex-shrink-0"},Q={class:"ml-3"},V={class:"ml-auto pl-3"},B=m(b({__name:"Waline",setup(i){const m=u(),b=o(""),B=o(""),q=o(""),P=o(""),z=o(!1),F=o(!1),K=o(""),Y=o([]),X=o({text:"",type:"success"}),Z=[{name:"QQ è¡¨æƒ…",icon:"ğŸ§",description:"QQ ç»å…¸è¡¨æƒ…åŒ…",url:"https://raw.githubusercontent.com/walinejs/emojis/main/qq/info.json"},{name:"å¾®ä¿¡è¡¨æƒ…",icon:"ğŸ’¬",description:"å¾®ä¿¡é»˜è®¤è¡¨æƒ…",url:"https://raw.githubusercontent.com/walinejs/emojis/main/weibo/info.json"},{name:"Bilibili",icon:"ğŸ“º",description:"Bç«™å°ç”µè§†è¡¨æƒ…",url:"https://raw.githubusercontent.com/walinejs/emojis/main/bilibili/info.json"},{name:"Tieba",icon:"ğŸ—£ï¸",description:"ç™¾åº¦è´´å§è¡¨æƒ…",url:"https://raw.githubusercontent.com/walinejs/emojis/main/tieba/info.json"},{name:"hoyoverse-hi3",icon:"ğŸŒŸ",description:"å´©åä¸‰è¡¨æƒ…åŒ…",url:"https://raw.githubusercontent.com/walinejs/emojis/main/hoyoverse-hi3/info.json"},{name:"coolapk",icon:"ğŸ˜Š",description:"coolapk è¡¨æƒ…åŒ…",url:"https://raw.githubusercontent.com/walinejs/emojis/main/coolapk/info.json"}];t(async()=>{await m.loadData()});const ee=e=>{const t=[];try{if("object"==typeof e&&null!==e){if(Array.isArray(e.items)&&e.prefix&&e.type){const s=e.prefix||"",a=e.type||"png",r=e.baseUrl||"https://cdn.jsdelivr.net/gh/walinejs/emojis/";for(const o of e.items)if("string"==typeof o){const l=o,n=`${r}${e.name?.toLowerCase()||"weibo"}/${s}${o}.${a}`;t.push({name:l,url:n})}}else for(const s in e){const a=e[s];if(a&&"object"==typeof a)if(Array.isArray(a.container)){for(const e of a.container)if(e&&"object"==typeof e){const s=e.text||e.name||e.title||`emoji-${t.length}`,a=e.src||e.url||e.icon;a&&"string"==typeof a&&t.push({name:s,url:a})}}else if(a.src||a.url){const e=a.text||a.name||`emoji-${t.length}`,s=a.src||a.url;t.push({name:e,url:s})}else for(const e in a){const s=a[e];if(s&&"object"==typeof s&&(s.src||s.url)){const a=s.text||s.name||e,r=s.src||s.url;t.push({name:a,url:r})}}}if(Array.isArray(e))for(const s of e)if(s&&"object"==typeof s){const e=s.text||s.name||s.title||`emoji-${t.length}`,a=s.src||s.url||s.icon;a&&"string"==typeof a&&t.push({name:e,url:a})}}}catch(s){console.error("Error parsing Waline config:",s)}return t},te=async()=>{if(!b.value.trim())return;z.value=!0;const e=Date.now().toString();try{const t=await fetch(b.value.trim());if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const s=await t.json(),a=ee(s);if(0===a.length)throw new Error("æœªæ‰¾åˆ°æœ‰æ•ˆçš„è¡¨æƒ…æ•°æ®");const r=B.value.trim()||"Waline è¡¨æƒ…åŒ…",o=await m.createGroup(r,"ğŸŒ");for(const e of a)m.addEmojiWithoutSave(o.id,{...e,packet:Date.now()+Math.floor(1e3*Math.random())});await m.saveData(),Y.value.unshift({id:e,groupName:r,groupId:o.id,success:!0,count:a.length}),re(`æˆåŠŸå¯¼å…¥ ${a.length} ä¸ªè¡¨æƒ…åˆ°åˆ†ç»„ "${r}"`,"success"),b.value="",B.value=""}catch(t){console.error("Import from URL failed:",t);const s=t instanceof Error?t.message:"å¯¼å…¥å¤±è´¥";Y.value.unshift({id:e,groupName:B.value.trim()||"Waline è¡¨æƒ…åŒ…",success:!1,error:s}),re(`å¯¼å…¥å¤±è´¥: ${s}`,"error")}finally{z.value=!1}},se=async()=>{if(!q.value.trim())return;F.value=!0;const e=Date.now().toString();try{const t=JSON.parse(q.value.trim()),s=ee(t);if(0===s.length)throw new Error("æœªæ‰¾åˆ°æœ‰æ•ˆçš„è¡¨æƒ…æ•°æ®");const a=P.value.trim()||"Waline è¡¨æƒ…åŒ…",r=await m.createGroup(a,"ğŸ“");for(const e of s)m.addEmojiWithoutSave(r.id,{...e,packet:Date.now()+Math.floor(1e3*Math.random())});await m.saveData(),Y.value.unshift({id:e,groupName:a,groupId:r.id,success:!0,count:s.length}),re(`æˆåŠŸå¯¼å…¥ ${s.length} ä¸ªè¡¨æƒ…åˆ°åˆ†ç»„ "${a}"`,"success"),q.value="",P.value=""}catch(t){console.error("Import from JSON failed:",t);const s=t instanceof Error?t.message:"å¯¼å…¥å¤±è´¥";Y.value.unshift({id:e,groupName:P.value.trim()||"Waline è¡¨æƒ…åŒ…",success:!1,error:s}),re(`JSON æ ¼å¼é”™è¯¯: ${s}`,"error")}finally{F.value=!1}},ae=()=>{Y.value=[]},re=(e,t="success")=>{X.value={text:e,type:t},setTimeout(()=>{X.value.text=""},3e3)};return(t,o)=>(a(),n("div",h,[o[17]||(o[17]=x('<header class="bg-white shadow-sm border-b border-gray-200 dark:bg-gray-800 dark:border-gray-700"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex justify-between items-center py-6"><div><h1 class="text-2xl font-bold text-gray-900 dark:text-white">Waline è¡¨æƒ…å¯¼å…¥</h1><p class="text-sm text-gray-600 dark:text-white"> ä» GitHub ä»“åº“æ‰¹é‡å¯¼å…¥ Waline é£æ ¼çš„è¡¨æƒ…åŒ… </p></div></div></div></header>',1)),l("main",y,[l("div",v,[l("div",w,[o[7]||(o[7]=l("h2",{class:"text-lg font-semibold text-gray-900 mb-4 dark:text-white"},"ä» URL å¯¼å…¥",-1)),o[8]||(o[8]=l("p",{class:"text-sm text-gray-600 mb-4 dark:text-white"},[r(" è¾“å…¥ Waline è¡¨æƒ…é…ç½®çš„ JSON URL æˆ– GitHub raw æ–‡ä»¶é“¾æ¥ "),l("br"),l("span",{class:"text-xs text-gray-500 dark:text-white"}," æ”¯æŒæ ‡å‡† Waline æ ¼å¼å’Œ Weibo é£æ ¼æ ¼å¼ ")],-1)),l("div",j,[l("div",null,[o[5]||(o[5]=l("label",{for:"url-input",class:"block text-sm font-medium text-gray-700"}," è¡¨æƒ…é…ç½® URL ",-1)),s(l("input",{id:"url-input","onUpdate:modelValue":o[0]||(o[0]=e=>b.value=e),type:"url",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"https://raw.githubusercontent.com/user/repo/main/emoji.json"},null,512),[[g,b.value]])]),l("div",null,[o[6]||(o[6]=l("label",{for:"url-group-name",class:"block text-sm font-medium text-gray-700"}," åˆ†ç»„åç§° ",-1)),s(l("input",{id:"url-group-name","onUpdate:modelValue":o[1]||(o[1]=e=>B.value=e),type:"text",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Waline è¡¨æƒ…åŒ…"},null,512),[[g,B.value]])]),l("button",{onClick:te,disabled:!b.value.trim()||z.value,class:"w-full px-4 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"},d(z.value?"å¯¼å…¥ä¸­...":"ä» URL å¯¼å…¥"),9,k)])]),l("div",$,[o[11]||(o[11]=l("h2",{class:"text-lg font-semibold text-gray-900 mb-4 dark:text-white"},"ä» JSON æ–‡æœ¬å¯¼å…¥",-1)),o[12]||(o[12]=l("p",{class:"text-sm text-gray-600 mb-4 dark:text-white"},[r(" ç›´æ¥ç²˜è´´ Waline è¡¨æƒ…é…ç½®çš„ JSON å†…å®¹ "),l("br"),l("span",{class:"text-xs text-gray-500 dark:text-white"}," æ”¯æŒæ ‡å‡† Waline æ ¼å¼å’Œ Weibo é£æ ¼æ ¼å¼ (åŒ…å« name, prefix, type, items çš„é…ç½®) ")],-1)),l("div",W,[l("div",null,[o[9]||(o[9]=l("label",{for:"json-input",class:"block text-sm font-medium text-gray-700"}," JSON é…ç½® ",-1)),s(l("textarea",{id:"json-input","onUpdate:modelValue":o[2]||(o[2]=e=>q.value=e),rows:"8",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm font-mono text-xs",placeholder:'ç¤ºä¾‹æ ¼å¼1: { "è¡¨æƒ…åŒ…å": { "type": "image", "container": [{ "icon": "ğŸ˜€", "text": "è¡¨æƒ…å", "src": "å›¾ç‰‡é“¾æ¥" }] } }\nç¤ºä¾‹æ ¼å¼2: { "name": "Weibo", "prefix": "weibo_", "type": "png", "items": ["smile", "lovely"] }'},null,512),[[g,q.value]])]),l("div",null,[o[10]||(o[10]=l("label",{for:"json-group-name",class:"block text-sm font-medium text-gray-700"}," åˆ†ç»„åç§° ",-1)),s(l("input",{id:"json-group-name","onUpdate:modelValue":o[3]||(o[3]=e=>P.value=e),type:"text",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Waline è¡¨æƒ…åŒ…"},null,512),[[g,P.value]])]),l("button",{onClick:se,disabled:!q.value.trim()||F.value,class:"w-full px-4 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"},d(F.value?"å¯¼å…¥ä¸­...":"ä» JSON å¯¼å…¥"),9,S)])])]),l("div",N,[o[13]||(o[13]=l("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"å¸¸ç”¨ Waline è¡¨æƒ…æº",-1)),o[14]||(o[14]=l("p",{class:"text-sm text-gray-600 mb-6"},"ç‚¹å‡»ä¸‹æ–¹é“¾æ¥å¿«é€Ÿå¯¼å…¥å¸¸ç”¨çš„ Waline è¡¨æƒ…åŒ…",-1)),l("div",E,[(a(),n(c,null,e(Z,e=>l("div",{key:e.name,class:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors"},[l("div",D,[l("span",U,d(e.icon),1),l("div",null,[l("h3",C,d(e.name),1),l("p",J,d(e.description),1)])]),l("button",{onClick:t=>(async e=>{K.value=e.name;const t=Date.now().toString();try{const s=await fetch(e.url);if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);const a=await s.json(),r=ee(a);if(0===r.length)throw new Error("æœªæ‰¾åˆ°æœ‰æ•ˆçš„è¡¨æƒ…æ•°æ®");const o=await m.createGroup(e.name,e.icon);for(const e of r)m.addEmojiWithoutSave(o.id,{...e,packet:Date.now()+Math.floor(1e3*Math.random())});await m.saveData(),Y.value.unshift({id:t,groupName:e.name,groupId:o.id,success:!0,count:r.length}),re(`æˆåŠŸå¯¼å…¥ ${e.name} (${r.length} ä¸ªè¡¨æƒ…)`,"success")}catch(s){console.error("Import from source failed:",s);const a=s instanceof Error?s.message:"å¯¼å…¥å¤±è´¥";Y.value.unshift({id:t,groupName:e.name,success:!1,error:a}),re(`å¯¼å…¥ ${e.name} å¤±è´¥: ${a}`,"error")}finally{K.value=""}})(e),disabled:K.value===e.name,class:"w-full mt-2 px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed transition-colors"},d(K.value===e.name?"å¯¼å…¥ä¸­...":"å¿«é€Ÿå¯¼å…¥"),9,O)])),64))])]),Y.value.length>0?(a(),n("div",T,[o[15]||(o[15]=l("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"å¯¼å…¥ç»“æœ",-1)),l("div",I,[(a(!0),n(c,null,e(Y.value,e=>(a(),n("div",{key:e.id,class:p(["flex items-center justify-between p-3 border border-gray-200 rounded-lg",{"border-green-200 bg-green-50":e.success,"border-red-200 bg-red-50":!e.success}])},[l("div",A,[l("span",{class:p(["w-6 h-6 flex items-center justify-center rounded-full text-sm",{"bg-green-100 text-green-600":e.success,"bg-red-100 text-red-600":!e.success}])},d(e.success?"âœ“":"âœ•"),3),l("div",null,[l("p",L,d(e.groupName),1),l("p",M,d(e.success?`æˆåŠŸå¯¼å…¥ ${e.count} ä¸ªè¡¨æƒ…`:e.error),1)])]),e.success?(a(),n("button",{key:0,onClick:t=>{var s;(s=e.groupId)&&window.open(`/options.html#groups=${s}`,"_blank")},class:"px-3 py-1 text-sm text-blue-600 hover:bg-blue-50 rounded transition-colors"}," æŸ¥çœ‹åˆ†ç»„ ",8,R)):f("",!0)],2))),128))]),l("div",{class:"mt-4 flex justify-end"},[l("button",{onClick:ae,class:"px-3 py-1 text-sm text-gray-600 hover:bg-gray-50 rounded transition-colors"}," æ¸…é™¤ç»“æœ ")])])):f("",!0)]),X.value.text?(a(),n("div",{key:0,class:p(["fixed top-4 right-4 max-w-sm w-full bg-white border border-gray-200 rounded-lg shadow-lg z-50",{"border-green-200 bg-green-50":"success"===X.value.type,"border-red-200 bg-red-50":"error"===X.value.type}])},[l("div",G,[l("div",_,[l("div",H,[l("span",{class:p(["w-5 h-5 flex items-center justify-center rounded-full text-sm",{"bg-green-100 text-green-600":"success"===X.value.type,"bg-red-100 text-red-600":"error"===X.value.type}])},d("success"===X.value.type?"âœ“":"âœ•"),3)]),l("div",Q,[l("p",{class:p(["text-sm font-medium",{"text-green-800":"success"===X.value.type,"text-red-800":"error"===X.value.type}])},d(X.value.text),3)]),l("div",V,[l("button",{onClick:o[4]||(o[4]=e=>X.value.text=""),class:"inline-flex text-gray-400 hover:text-gray-600"},[...o[16]||(o[16]=[l("span",{class:"sr-only"},"å…³é—­",-1),r(" âœ• ",-1)])])])])])],2)):f("",!0)]))}})),q=i();B.use(q),B.mount("#app");